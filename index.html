<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GPS Speedometer</title>

  <style>
    :root {
      --bg: #0b0f1a;
      --panel: #121a2f;
      --text: #e8ecff;
      --muted: rgba(232,236,255,.7);
      --accent: #6ea8ff;
      --danger: #ff5a7a;
      --ok: #53d6a0;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      background: radial-gradient(1200px 800px at 50% 30%, #152040 0%, var(--bg) 60%);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }

    .card {
      width: min(520px, 94vw);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border-radius: 18px;
      padding: 18px;
      border: 1px solid rgba(255,255,255,.1);
      box-shadow: 0 20px 50px rgba(0,0,0,.5);
    }

    .header {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      margin-bottom: 10px;
      color: var(--muted);
    }

    .gauge {
      position: relative;
      width: 100%;
      aspect-ratio: 1 / 1;
      border-radius: 50%;
      display: grid;
      place-items: center;
    }

    .track {
      position: absolute;
      inset: 10%;
      border-radius: 50%;
      background: conic-gradient(
        from 225deg,
        rgba(255,255,255,.15) 0 270deg,
        transparent 0
      );
      mask: radial-gradient(circle, transparent 61%, black 62%);
    }

    .arc {
      position: absolute;
      inset: 10%;
      border-radius: 50%;
      background: conic-gradient(
        from 225deg,
        var(--ok) 0deg,
        var(--accent) 120deg,
        var(--danger) 240deg,
        transparent 0deg
      );
      mask: radial-gradient(circle, transparent 61%, black 62%);
      opacity: .95;
    }

    .needle {
      position: absolute;
      width: 45%;
      height: 4px;
      left: 50%;
      top: 50%;
      transform-origin: 0% 50%;
      transform: translateY(-50%) rotate(225deg);
      transition: transform 120ms linear;
      background: linear-gradient(90deg, transparent, #fff 20%, #ff5a7a 90%);
      border-radius: 999px;
    }

    .hub {
      position: absolute;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: radial-gradient(circle, #fff, #000 70%);
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
    }

    .inner {
      position: absolute;
      inset: 20%;
      border-radius: 50%;
      background: linear-gradient(180deg, #121a2f, #0a0f1f);
      border: 1px solid rgba(255,255,255,.1);
      display: grid;
      place-items: center;
      text-align: center;
    }

    .speed {
      font-size: 56px;
      line-height: 1;
    }

    .unit {
      font-size: 12px;
      color: var(--muted);
      letter-spacing: .5px;
    }

    .status {
      font-size: 12px;
      color: var(--muted);
      margin-top: 4px;
    }

    .footer {
      margin-top: 10px;
      font-size: 12px;
      color: var(--muted);
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="card">
    <div class="header">
      <div>GPS Speedometer</div>
      <div>0 – 200 km/h</div>
    </div>

    <div class="gauge">
      <div class="track"></div>
      <div class="arc"></div>
      <div class="needle" id="needle"></div>
      <div class="hub"></div>

      <div class="inner">
        <div>
          <div class="speed" id="speed">0</div>
          <div class="unit">km/h</div>
          <div class="status" id="status">Waiting for GPS…</div>
        </div>
      </div>
    </div>

    <div class="footer">
      Speed = distance ÷ time (GPS-based)
    </div>
  </div>

  <script>
    const START_DEG = 225;
    const SWEEP_DEG = 270;
    const MAX_SPEED = 200;

    const needle = document.getElementById("needle");
    const speedEl = document.getElementById("speed");
    const statusEl = document.getElementById("status");

    let last = null;

    function toRad(d) {
      return d * Math.PI / 180;
    }

    function haversine(lat1, lon1, lat2, lon2) {
      const R = 6371000;
      const dLat = toRad(lat2 - lat1);
      const dLon = toRad(lon2 - lon1);

      const a =
        Math.sin(dLat / 2) ** 2 +
        Math.cos(toRad(lat1)) *
        Math.cos(toRad(lat2)) *
        Math.sin(dLon / 2) ** 2;

      return 2 * R * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    }

    function setSpeed(speed) {
      speed = Math.max(0, Math.min(speed, MAX_SPEED));
      speedEl.textContent = Math.round(speed);

      const angle = START_DEG + (speed / MAX_SPEED) * SWEEP_DEG;
      needle.style.transform = `translateY(-50%) rotate(${angle}deg)`;
    }

    if ("geolocation" in navigator) {
      navigator.geolocation.watchPosition(
        pos => {
          const { latitude, longitude } = pos.coords;
          const time = pos.timestamp;

          if (last) {
            const d = haversine(
              last.lat, last.lon,
              latitude, longitude
            );

            const dt = (time - last.time) / 1000;

            if (dt > 0) {
              const speed = (d / dt) * 3.6;
              setSpeed(speed);
              statusEl.textContent = "GPS active";
            }
          }

          last = { lat: latitude, lon: longitude, time };
        },
        err => {
          statusEl.textContent = "GPS error";
          console.error(err);
        },
        {
          enableHighAccuracy: true,
          maximumAge: 500,
          timeout: 5000
        }
      );
    } else {
      statusEl.textContent = "Geolocation not supported";
    }
  </script>
</body>
</html>
