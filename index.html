<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Osama Meter</title>

<style>
:root{
  --bg:#000;
  --white:#f5f7ff;
  --gray:#9aa3b2;
  --red:#ff2a4f;
}

*{box-sizing:border-box}
html,body{height:100%}

body{
  margin:0;
  background:#000;
  color:var(--white);
  font-family:system-ui,Segoe UI,Roboto,Arial;
  display:grid;
  place-items:center;
}

/* FRAME */
.hud{
  width:min(620px,96vw);
  aspect-ratio:1/1;
  position:relative;
}

/* SPEED RING */
.ring{
  position:absolute;
  inset:8%;
  border-radius:50%;
  background:
    conic-gradient(from 225deg,
      #fff 0deg,
      #fff 160deg,
      var(--red) 260deg,
      transparent 0deg);
  mask:radial-gradient(circle,transparent 64%,black 65%);
}

/* Segments overlay */
.ring::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:50%;
  background:
    repeating-conic-gradient(
      from 225deg,
      transparent 0deg 4deg,
      rgba(0,0,0,.85) 4deg 7deg
    );
  mask:radial-gradient(circle,transparent 64%,black 65%);
}

/* CENTER */
.center{
  position:absolute;
  inset:30%;
  display:grid;
  place-items:center;
  text-align:center;
}

.speed{
  font-size:96px;
  font-weight:900;
  line-height:1;
}

.unit{
  font-size:18px;
  letter-spacing:2px;
  color:var(--gray);
}

.gear-label{
  margin-top:10px;
  font-size:14px;
  color:var(--gray);
}
.gear{
  font-size:36px;
  color:var(--red);
  font-weight:900;
}

/* SIDE ARROWS */
.arrow{
  position:absolute;
  top:50%;
  width:30px;
  height:60px;
  background:#fff;
  clip-path:polygon(0 50%,100% 0,100% 100%);
}
.arrow.left{left:0;transform:translateY(-50%)}
.arrow.right{right:0;transform:translateY(-50%) rotate(180deg)}

/* BATTERY */
.battery{
  position:absolute;
  right:10%;
  bottom:20%;
  width:14px;
  height:120px;
  border:2px solid #fff;
  padding:2px;
}
.battery-level{
  width:100%;
  background:var(--red);
  height:50%;
}

/* TITLE */
.title{
  position:absolute;
  top:6%;
  width:100%;
  text-align:center;
  font-size:18px;
  letter-spacing:2px;
}
.subtitle{
  font-size:14px;
  color:var(--gray);
}
</style>
</head>

<body>
<div class="hud" id="hud">
  <div class="title">
    Osama Meter<br>
    <span class="subtitle">دراجة عبد الحليم</span>
  </div>

  <div class="ring"></div>

  <div class="center">
    <div class="speed" id="speed">0</div>
    <div class="unit">KM/H</div>
    <div class="gear-label">GEAR</div>
    <div class="gear" id="gear">1</div>
  </div>

  <div class="battery">
    <div class="battery-level" id="battery"></div>
  </div>

  <div class="arrow left"></div>
  <div class="arrow right"></div>
</div>

<script>
/* ===== SPEED + GEAR ===== */
let ema=0,last=null;
const EMA=0.22;

function gearFromSpeed(v){
  if(v<=10) return 1;
  if(v<=15) return 2;
  if(v<=20) return 3;
  if(v<=25) return 4;
  return 5;
}

navigator.geolocation.watchPosition(p=>{
  let kmh=p.coords.speed!=null
    ? p.coords.speed*3.6
    : 0;

  ema=EMA*kmh+(1-EMA)*ema;

  document.getElementById("speed").textContent=Math.round(ema);
  document.getElementById("gear").textContent=gearFromSpeed(ema);
},
()=>{},
{enableHighAccuracy:true});

/* ===== BATTERY ===== */
navigator.getBattery().then(b=>{
  function update(){
    document.getElementById("battery").style.height=
      (b.level*100)+"%";
  }
  update();
  b.addEventListener("levelchange",update);
});
</script>
</body>
</html>
